import{a as A}from"./chunk-37SX64XK.js";import{Da as C,Fa as c,Ha as t,Ia as e,Ja as u,Ma as w,Na as f,Oa as b,Pa as _,Qa as i,Ra as d,Sa as p,W as S,Ya as P,Za as g,_a as x,c as y,da as h,ea as v,ra as I,ta as a,ua as E,wb as U,yb as O,zb as N}from"./chunk-4CJDLHC2.js";function M(m,o){if(m&1){let r=w();t(0,"tr")(1,"td",31)(2,"div",32),u(3,"img",33),t(4,"div",34)(5,"a",35),i(6),e()()()(),t(7,"td",36),i(8),g(9,"currency"),e(),t(10,"td",37)(11,"input",38),f("change",function(l){let s=h(r).$implicit,D=b();return v(D.updateQuantity(s,l))}),e()(),t(12,"td",36),i(13),g(14,"currency"),e(),t(15,"td",39)(16,"a",40),f("click",function(){let l=h(r).$implicit,s=b();return v(s.removeUserItem(l.id))}),i(17,"\xD7"),e()()()}if(m&2){let r=o.$implicit;a(3),_("alt",r.title),c("src",r.image,I),a(3),d(r.title),a(2),d(x(9,6,r.price)),a(3),c("value",r.quantity),a(2),d(x(14,8,r.price*r.quantity))}}var k=class m{constructor(o){this.userCartService=o}user=null;cartArray=[];cartSubscription=new y;ngOnInit(){this.getUser(),this.getCart()}totalPrice(){return this.cartArray.reduce((o,r)=>o+r.price*r.quantity,0)}getUser(){let o=sessionStorage.getItem("user");o?this.user=JSON.parse(o):this.user=null}getCart(){this.user&&(this.cartSubscription=this.userCartService.getProduct({userId:this.user.userId}).subscribe(o=>{this.cartArray=o},o=>{console.error("Error fetching cart data",o)}))}updateQuantity(o,r){let n=r.target,l=Number(n.value);l>0&&!isNaN(l)?(o.quantity=l,this.userCartService.updateQuantity(o.id,o.userId.toString(),l.toString()).subscribe(s=>{console.log("Item quantity updated:",s)},s=>{console.error("Error updating item:",s)})):console.error("Invalid quantity")}removeUserItem(o){if(!this.user){console.error("User is not authenticated.");return}let r=this.cartArray.find(n=>n.id===o&&n.userId===this.user?.userId);r?this.userCartService.deleteProduct(r.id,r.userId.toString()).subscribe(()=>{console.log("Item removed from cart"),this.cartArray=this.cartArray.filter(n=>n.id!==o)},n=>{console.error("Error removing item from cart:",n)}):console.error("Item not found or does not belong to the current user.")}ngOnDestroy(){this.cartSubscription&&this.cartSubscription.unsubscribe()}static \u0275fac=function(r){return new(r||m)(E(A))};static \u0275cmp=S({type:m,selectors:[["app-user-page"]],standalone:!0,features:[P],decls:73,vars:9,consts:[[1,"container","mt-5"],[1,"row"],[1,"col-md-4"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"list-group"],[1,"list-group-item"],[1,"badge","badge-primary"],[1,"card-footer","text-muted"],[1,"col-md-8"],[1,"table-responsive"],[1,"table","table-bordered","m-0"],[1,"text-center","py-3","px-4",2,"min-width","400px"],[1,"text-right","py-3","px-4",2,"width","100px"],[1,"text-center","py-3","px-4",2,"width","120px"],[1,"text-center","py-3","px-0",2,"width","40px"],["href","#","title","Clear cart",1,"shop-tooltip","float-none","text-light"],[1,"ino","ion-md-trash"],[4,"ngFor","ngForOf"],[1,"d-flex","flex-wrap","justify-content-between","align-items-center","pb-4"],[1,"mt-4"],[1,"text-muted","font-weight-normal"],["type","text","placeholder","ABC",1,"form-control"],[1,"d-flex"],[1,"text-right","mt-4"],[1,"text-muted","font-weight-normal","m-0"],[1,"text-large"],[1,"float-right"],["type","button",1,"btn","btn-lg","btn-default","md-btn-flat","mt-2","mr-3"],["type","button",1,"btn","btn-lg","btn-primary","mt-2"],[1,"p-4"],[1,"media","align-items-center"],[1,"d-block","ui-w-40","ui-bordered","mr-4",3,"src","alt"],[1,"media-body"],["href","#",1,"d-block","text-dark"],[1,"text-right","font-weight-semibold","align-middle","p-4"],[1,"align-middle","p-4"],["type","number","min","1",1,"form-control","text-center",3,"change","value"],[1,"text-center","align-middle","px-0"],["title","Remove",1,"shop-tooltip","close","float-none","text-danger",3,"click"]],template:function(r,n){r&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4"),i(6,"User Information"),e()(),t(7,"div",5)(8,"ul",6)(9,"li",7)(10,"strong"),i(11,"User Name:"),e(),i(12),e(),t(13,"li",7)(14,"strong"),i(15,"Registration Date:"),e(),i(16),e(),t(17,"li",7)(18,"strong"),i(19,"Is Admin:"),e(),t(20,"span",8),i(21),e()(),t(22,"li",7)(23,"strong"),i(24,"Password:"),e(),i(25),e(),t(26,"li",7)(27,"strong"),i(28,"User ID:"),e(),i(29),e()()(),t(30,"div",9),i(31," User profile details "),e()()(),t(32,"div",10)(33,"div",3)(34,"div",4)(35,"h2"),i(36,"Shopping Cart"),e()(),t(37,"div",5)(38,"div",11)(39,"table",12)(40,"thead")(41,"tr")(42,"th",13),i(43,"Product Name & Details"),e(),t(44,"th",14),i(45,"Price"),e(),t(46,"th",15),i(47,"Quantity"),e(),t(48,"th",14),i(49,"Total"),e(),t(50,"th",16)(51,"a",17),u(52,"i",18),e()()()(),t(53,"tbody"),C(54,M,18,10,"tr",19),e()()(),t(55,"div",20)(56,"div",21)(57,"label",22),i(58,"Promocode"),e(),u(59,"input",23),e(),t(60,"div",24)(61,"div",25)(62,"label",26),i(63,"Total price"),e(),t(64,"div",27)(65,"strong"),i(66),g(67,"currency"),e()()()()(),t(68,"div",28)(69,"button",29),i(70,"Back to shopping"),e(),t(71,"button",30),i(72,"Checkout"),e()()()()()()()),r&2&&(a(12),p(" ",n.user==null?null:n.user.userName,""),a(4),p(" ",n.user==null?null:n.user.registrationDate,""),a(5),d(n.user!=null&&n.user.isAdmin?"Yes":"No"),a(4),p(" ",n.user==null?null:n.user.password,""),a(4),p(" ",n.user==null?null:n.user.userId,""),a(25),c("ngForOf",n.cartArray),a(12),d(x(67,7,n.totalPrice())))},dependencies:[N,U,O],styles:["body[_ngcontent-%COMP%]{margin-top:20px;background:#eee}.ui-w-40[_ngcontent-%COMP%]{width:40px!important;height:auto}.card[_ngcontent-%COMP%]{box-shadow:0 1px 15px 1px #34286814}.ui-product-color[_ngcontent-%COMP%]{display:inline-block;overflow:hidden;margin:.144em;width:.875rem;height:.875rem;border-radius:10rem;-webkit-box-shadow:0 0 0 1px rgba(0,0,0,.15) inset;box-shadow:0 0 0 1px #00000026 inset;vertical-align:middle}"]})};export{k as UserPageComponent};
